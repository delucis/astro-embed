---
export interface Props {
  url: string;
  dark: boolean;
  compact: boolean;
  widthPercent?: number;
  embedClass: string;
}
const {
  url,
  dark = false,
  compact = false,
  widthPercent = 100,
  embedClass = '',
} = Astro.props;

// values based on Spotify embed generator
let height = compact ? 152 : 352;
let theme = dark ? 0 : 1;

const { pathname } = new URL(url);
let [type, ...params] = pathname.split('/').filter(Boolean);
type = type === 'user' ? 'playlist' : type;
const id = params.slice(-1);

const embedUrl = `https://open.spotify.com/embed/${type}/${id}?theme=${theme}`;
console.log(embedUrl);
---

<iframe
  class={embedClass}
  style="border-radius:12px"
  src={embedUrl}
  width=`${widthPercent}%`
  height=`${height}`
  frameBorder="0"
  allowfullscreen=""
  allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture"
  loading="lazy"></iframe>
