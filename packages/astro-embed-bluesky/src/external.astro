---
import { AppBskyEmbedExternal } from '@atproto/api';
import './styles.css';

interface Props {
	embed: AppBskyEmbedExternal.View;
	compact?: boolean | undefined;
}

const { uri, thumb, title, description } = Astro.props.embed.external;
const domain = new URL(uri).hostname;
const { compact } = Astro.props;
---

<a href={uri} target="_blank" rel="noopener noreferrer nofollow">
	{!compact && <img src={thumb} alt={title} />}
	<div class="content">
		<p class="domain">{domain}</p>
		{
			!compact && (
				<>
					<p class="title">{title}</p>
					<p class="description">{description}</p>
				</>
			)
		}
	</div>
</a>

<style>
	a {
		display: flex;
		flex-direction: column;
		width: 100%;
		border: 1px solid var(--color-border);
		border-radius: var(--radius-md);
		overflow: hidden;
		text-decoration: none;
		color: inherit;
		background: var(--color-background);
		transition: background-color 0.2s;
	}

	a:hover {
		background: var(--color-background-hover);
	}

	img {
		aspect-ratio: var(--aspect-ratio-thumb);
		width: 100%;
		height: auto;
		object-fit: cover;
	}

	.content {
		padding: var(--content-padding);
	}

	.domain {
		font-size: var(--font-size-sm);
		color: var(--color-text-light);
		margin: 0;
		overflow: hidden;
		text-overflow: ellipsis;
		white-space: nowrap;
	}

	.title {
		font-weight: 600;
		margin: 0;
		overflow: hidden;
	}

	.description {
		font-size: var(--font-size-sm);
		color: var(--color-text-light);
		margin: var(--space-xs) 0 0 0;
		overflow: hidden;
	}
</style>
